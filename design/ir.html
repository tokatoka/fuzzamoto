<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Intermediate Representation - Fuzzamoto Documentation</title>
                

        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

                <link rel="icon" href="../favicon.svg">
                        <link rel="shortcut icon" href="../favicon.png">
                <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
                <link rel="stylesheet" href="../css/print.css" media="print">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="../fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../index.html">Introduction</a></li><li class="chapter-item expanded affix "><li class="part-title">Design</li><li class="chapter-item expanded "><a href="../design/snapshot-fuzzing.html"><strong aria-hidden="true">1.</strong> Snapshot Fuzzing</a></li><li class="chapter-item expanded "><a href="../design/scenarios.html"><strong aria-hidden="true">2.</strong> Scenarios</a></li><li class="chapter-item expanded "><a href="../design/ir.html" class="active"><strong aria-hidden="true">3.</strong> Intermediate Representation</a></li><li class="chapter-item expanded affix "><li class="part-title">Usage</li><li class="chapter-item expanded "><a href="../usage/aflpp.html"><strong aria-hidden="true">4.</strong> Fuzzing with AFL++</a></li><li class="chapter-item expanded "><a href="../usage/libafl.html"><strong aria-hidden="true">5.</strong> Fuzzing with fuzzamoto-libafl</a></li><li class="chapter-item expanded "><a href="../usage/reproducing.html"><strong aria-hidden="true">6.</strong> Reproducing Testcases</a></li><li class="chapter-item expanded "><a href="../usage/target-patches.html"><strong aria-hidden="true">7.</strong> Custom Target Patches</a></li><li class="chapter-item expanded "><a href="../usage/coverage.html"><strong aria-hidden="true">8.</strong> Coverage Reports</a></li><li class="chapter-item expanded "><a href="../usage/requirements.html"><strong aria-hidden="true">9.</strong> System Requirements</a></li><li class="chapter-item expanded affix "><li class="part-title">Contributing</li><li class="chapter-item expanded "><a href="../contributing/integrating.html"><strong aria-hidden="true">10.</strong> Integrating New Targets</a></li><li class="chapter-item expanded "><a href="../contributing/scenarios.html"><strong aria-hidden="true">11.</strong> Writing New Scenarios</a></li><li class="chapter-item expanded "><a href="../contributing/ir.html"><strong aria-hidden="true">12.</strong> Extending Fuzzamoto IR</a></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                                            </div>

                    <h1 class="menu-title">Fuzzamoto Documentation</h1>

                    <div class="right-buttons">
                                                <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                                                                        
                    </div>
                </div>

                                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="fuzzamoto-intermediate-representation"><a class="header" href="#fuzzamoto-intermediate-representation">Fuzzamoto Intermediate Representation</a></h1>
<p>At a high level, generic p2p testcases represent a sequence of actions
performed against one or more target nodes:</p>
<ul>
<li>Changing system time</li>
<li>Establishing a new p2p connection</li>
<li>Sending protocol messages on an established connection</li>
</ul>
<p>Protocol messages in particular are highly structured, as they are serialized
using a <a href="https://github.com/bitcoin/bitcoin/blob/master/src/serialize.h">custom
format</a>,
contain various cryptographic primitives (hash commitments, signatures,
checksums, ...) and must fullfil various other structural requirements to be
considered valid, such as:</p>
<ul>
<li>Block headers must point to a prior block via its hash</li>
<li>Transaction inputs must point to existing unspent transactions outputs via
transaction identifiers</li>
<li><code>blocktxn</code> messages are only processed if requested (after a prior
<code>cmpctblock</code> message)</li>
<li>...</li>
</ul>
<p>Therefore, naively fuzzing a scenario with a byte-array fuzzer, using the
following input format (with e.g.
<a href="https://github.com/rust-fuzz/arbitrary"><code>Arbitrary</code></a>) will mostly result in
fuzzing the message (de)serialization code and other easy to reach protocol
flows.</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub enum Action {
    SetTime { ... },
    Connect { ... },
    SendMessage { ... },
}

pub struct TestCase {
    pub actions: Vec&lt;Action&gt;,
}
<span class="boring">}
</span></code></pre></pre>
<p>If we want to focus on fuzzing deeper logic instead, then we'll need to make
input generation/mutation aware of the structural requirements. This is where an
intermediate representation, that holds relevant type and structural
information, becomes useful.</p>
<p>Fuzzamoto IR describes small programs that can be compiled into the simple
testcase format from above (<code>TestCase</code>). For the purpose of
mutation/generation, the fuzzer (<a href="../usage/libafl.html"><code>fuzzamoto-libafl</code></a>)
operates on testcases encoded as the IR (as it contains relevant type and
structural information) and only compiles it to the simple format for target
execution.</p>
<pre><code>┌───────────────────────────────────────Fuzzer───────────────────────────────────────┐
│                                                                                    │
│ ┌─────────────┐                  ┌────────┐                   ┌──────────────────┐ │
│ │ Corpus (IR) ├──────Select─────►│ Mutate ├──────Compile──────► Target Execution │ │
│ └─────────────┘                  └────────┘                   └──────────────────┘ │
│                                                                                    │
└────────────────────────────────────────────────────────────────────────────────────┘
</code></pre>
<h2 id="design"><a class="header" href="#design">Design</a></h2>
<p>Fuzzamoto IR consists of a sequence of operations that take some input
variables and produce variables as output. All variables are typed (see
<a href="https://github.com/dergoegge/fuzzamoto/tree/master/fuzzamoto-ir/src/variable.rs">variable.rs</a>)
and operations expect variables of compatible type. The IR uses static single
assignement form (SSA), which means every variable in the IR is assigned
exactly once. SSA helps simplify define-use analysis, type inference and code
generation/mutation among other things.</p>
<p>Each IR program is associated with a context that represents the snapshot state
of the test VM:</p>
<ul>
<li>Mock time</li>
<li>Number of nodes</li>
<li>Number of existing connections made by the scenario</li>
<li>Available transaction outputs (Used for <code>LoadTxo</code> instructions)</li>
<li>Available block headers (Used for <code>LoadHeader</code> instructions)</li>
</ul>
<p>Programs might not be valid/useful in a different context. E.g. a program that
was generated within the context of 10 nodes and 200 connections might not be
valid in a context with 1 nodes and 8 connections, as it might refer to
non-existent nodes or connections.</p>
<p>In the following simple example, the IR describes the creation of a tx message
from raw bytes that is then send to a node via one of the existing connections:</p>
<pre><code>// Context: nodes=1 connections=8 timestamp=1296688802
v0 &lt;- LoadConnection(5)
v1 &lt;- LoadMsgType(&quot;tx&quot;)
v2 &lt;- LoadBytes(&quot;fefe8520fefefe0000fffffe8520&quot;)
SendRawMessage(v0, v1, v2)
</code></pre>
<p><em>Note that this is a human readable representation and not the internal
in-memory structure used by the fuzzer.</em></p>
<p>This example would compile into a single <code>TestCase::SendMessage</code> operation.</p>
<p>The next example is more complex and better demonstrates the strengths of the
IR:</p>
<pre><code>// Context: nodes=1 connections=8 timestamp=1296688802
v0 &lt;- LoadBytes(&quot;5656565656565656567a7a7a7a7a7a7a7a7a7aa9ffff5656567a506464649b64596464f16463646464&quot;)
v1 &lt;- LoadTxo(083666c9bf066f9d3a28ad30f5c0ed6fe463f7777e033783875b2523ef5214bb:0, 2500000000, 00204ae81572f06e1b88fd5ced7a1a000945432e83e1551e6f721ee9c00b8cc33260, , 51)
v2 &lt;- LoadConnection(4)
v3 &lt;- LoadTxVersion(2)
v4 &lt;- LoadLockTime(144)
BeginBuildTx(v3, v4) -&gt; v5
  BeginBuildTxInputs -&gt; v6
    v7 &lt;- LoadSequence(4294967295)
    AddTxInput(v6, v1, v7)
  v8 &lt;- EndBuildTxInputs(v6)
  BeginBuildTxOutputs(v8) -&gt; v9
    BeginWitnessStack -&gt; v10
    v11 &lt;- EndWitnessStack(v10)
    v12 &lt;- BuildPayToWitnessScriptHash(v0, v11)
    v13 &lt;- LoadAmount(100000000)
    AddTxOutput(v9, v12, v13)
  v14 &lt;- EndBuildTxOutputs(v9)
v15 &lt;- EndBuildTx(v5, v8, v14)
v16 &lt;- TakeTxo(v15)
v17 &lt;- LoadLockTime(508195987)
v18 &lt;- LoadTxVersion(2)
BeginBuildTx(v18, v17) -&gt; v19
  BeginBuildTxInputs -&gt; v20
    v21 &lt;- LoadSequence(4294967294)
    AddTxInput(v20, v16, v21)
  v22 &lt;- EndBuildTxInputs(v20)
  BeginBuildTxOutputs(v22) -&gt; v23
    v24 &lt;- LoadBytes(&quot;51&quot;)
    BeginWitnessStack -&gt; v25
    v26 &lt;- EndWitnessStack(v25)
    v27 &lt;- BuildPayToWitnessScriptHash(v24, v26)
    v28 &lt;- LoadAmount(98500000)
    AddTxOutput(v23, v27, v28)
  v29 &lt;- EndBuildTxOutputs(v23)
v30 &lt;- EndBuildTx(v19, v22, v29)
SendTx(v2, v30)
SendTx(v2, v15)
</code></pre>
<p>Two transactions are build (<code>v15</code>, <code>v30</code>), that are then send to the node under
test through connection <code>v2</code>. <code>v15</code> spends from an output in the snapshot state
<code>v1</code> (loaded by <code>LoadTxo</code>). The relationship between the two transactions (i.e.
<code>v30</code> is the parent of <code>v15</code>) is encoded in the IR through the use of
variables. <code>v16</code> (output of <code>TakeTxo</code>) represents the output created by <code>v15</code>
and is added to <code>v30</code> via the <code>AddTxInput</code> instruction in the <code>BuildTxInputs</code>
block. <code>v30</code> is sent before <code>v15</code> potentially triggering 1P1C logic.</p>
<p>This example would compile into two <code>TestCase::SendMessage</code> operations,
containing the correctly serialized transactions <code>v15</code> and <code>v30</code>.</p>
<h3 id="table-of-operations"><a class="header" href="#table-of-operations">Table of Operations</a></h3>
<table><thead><tr><th align="left">Name</th><th align="left">Description</th></tr></thead><tbody>
<tr><td align="left"><strong><code>Load*</code> operations</strong></td><td align="left"><strong>Load constant values from the test context.</strong></td></tr>
<tr><td align="left"><code>LoadBytes</code></td><td align="left">Loads a raw byte array.</td></tr>
<tr><td align="left"><code>LoadMsgType</code></td><td align="left">Loads a message type for <code>SendRawMessage</code>.</td></tr>
<tr><td align="left"><code>LoadNode</code></td><td align="left">Loads an index for one of the test nodes.</td></tr>
<tr><td align="left"><code>LoadConnection</code></td><td align="left">Loads an index for one of the p2p connections.</td></tr>
<tr><td align="left"><code>LoadConnectionType</code></td><td align="left">Loads a connection type string.</td></tr>
<tr><td align="left"><code>LoadDuration</code></td><td align="left">Loads a time duration.</td></tr>
<tr><td align="left"><code>LoadTime</code></td><td align="left">Loads a timestamp.</td></tr>
<tr><td align="left"><code>LoadAmount</code></td><td align="left">Loads a bitcoin amount.</td></tr>
<tr><td align="left"><code>LoadSize</code></td><td align="left">Loads a size in bytes.</td></tr>
<tr><td align="left"><code>LoadTxVersion</code></td><td align="left">Loads a transaction version.</td></tr>
<tr><td align="left"><code>LoadBlockVersion</code></td><td align="left">Loads a block version.</td></tr>
<tr><td align="left"><code>LoadLockTime</code></td><td align="left">Loads a transaction lock time.</td></tr>
<tr><td align="left"><code>LoadSequence</code></td><td align="left">Loads a transaction input sequence number.</td></tr>
<tr><td align="left"><code>LoadBlockHeight</code></td><td align="left">Loads a block height.</td></tr>
<tr><td align="left"><code>LoadCompactFilterType</code></td><td align="left">Loads a compact filter type.</td></tr>
<tr><td align="left"><code>LoadPrivateKey</code></td><td align="left">Loads a private key.</td></tr>
<tr><td align="left"><code>LoadSigHashFlags</code></td><td align="left">Loads signature hash flags.</td></tr>
<tr><td align="left"><code>LoadTxo</code></td><td align="left">Loads a transaction output from the context.</td></tr>
<tr><td align="left"><code>LoadHeader</code></td><td align="left">Loads a block header from the context.</td></tr>
<tr><td align="left"><strong>Time operations</strong></td><td align="left"><strong>Manipulate the mock time.</strong></td></tr>
<tr><td align="left"><code>AdvanceTime</code></td><td align="left">Advances time by a given duration.</td></tr>
<tr><td align="left"><code>SetTime</code></td><td align="left">Sets the mock time to a specific value.</td></tr>
<tr><td align="left"><strong>Script building</strong></td><td align="left"><strong>Construct various bitcoin scripts.</strong></td></tr>
<tr><td align="left"><code>BuildRawScripts</code></td><td align="left">Build raw scripts (<code>scriptSig</code>, <code>scriptPubKey</code>, witness).</td></tr>
<tr><td align="left"><code>BuildPayToWitnessScriptHash</code></td><td align="left">Creates a P2WSH script.</td></tr>
<tr><td align="left"><code>BuildPayToPubKey</code></td><td align="left">Creates a P2PK script.</td></tr>
<tr><td align="left"><code>BuildPayToPubKeyHash</code></td><td align="left">Creates a P2PKH script.</td></tr>
<tr><td align="left"><code>BuildPayToWitnessPubKeyHash</code></td><td align="left">Creates a P2WPKH script.</td></tr>
<tr><td align="left"><code>BuildPayToScriptHash</code></td><td align="left">Creates a P2SH script.</td></tr>
<tr><td align="left"><code>BuildOpReturnScripts</code></td><td align="left">Creates an OP_RETURN script.</td></tr>
<tr><td align="left"><code>BuildPayToAnchor</code></td><td align="left">Creates a P2A (pay-to-anchor) script for CPFP.</td></tr>
<tr><td align="left"><strong>Witness stack</strong></td><td align="left"><strong>Construct a witness stack.</strong></td></tr>
<tr><td align="left"><code>BeginWitnessStack</code></td><td align="left">Begins building a witness stack.</td></tr>
<tr><td align="left"><code>AddWitness</code></td><td align="left">Adds an item to the witness stack.</td></tr>
<tr><td align="left"><code>EndWitnessStack</code></td><td align="left">Finishes building the witness stack.</td></tr>
<tr><td align="left"><strong>Transaction building</strong></td><td align="left"><strong>Construct a transaction.</strong></td></tr>
<tr><td align="left"><code>BeginBuildTx</code></td><td align="left">Begins building a transaction.</td></tr>
<tr><td align="left"><code>BeginBuildTxInputs</code></td><td align="left">Begins building transaction inputs.</td></tr>
<tr><td align="left"><code>AddTxInput</code></td><td align="left">Adds an input to the transaction.</td></tr>
<tr><td align="left"><code>EndBuildTxInputs</code></td><td align="left">Finishes building transaction inputs.</td></tr>
<tr><td align="left"><code>BeginBuildTxOutputs</code></td><td align="left">Begins building transaction outputs.</td></tr>
<tr><td align="left"><code>AddTxOutput</code></td><td align="left">Adds an output to the transaction.</td></tr>
<tr><td align="left"><code>EndBuildTxOutputs</code></td><td align="left">Finishes building transaction outputs.</td></tr>
<tr><td align="left"><code>EndBuildTx</code></td><td align="left">Finishes building the transaction.</td></tr>
<tr><td align="left"><code>TakeTxo</code></td><td align="left">Extracts a specific output from a transaction.</td></tr>
<tr><td align="left"><strong>Block building</strong></td><td align="left"><strong>Construct a block.</strong></td></tr>
<tr><td align="left"><code>BeginBlockTransactions</code></td><td align="left">Begins building the list of transactions for a block.</td></tr>
<tr><td align="left"><code>AddTx</code></td><td align="left">Adds a transaction to the block.</td></tr>
<tr><td align="left"><code>EndBlockTransactions</code></td><td align="left">Finishes building the list of transactions.</td></tr>
<tr><td align="left"><code>BuildBlock</code></td><td align="left">Builds a block.</td></tr>
<tr><td align="left"><strong>Inventory building</strong></td><td align="left"><strong>Construct an inventory for <code>inv</code> and <code>getdata</code> messages.</strong></td></tr>
<tr><td align="left"><code>BeginBuildInventory</code></td><td align="left">Begins building an inventory.</td></tr>
<tr><td align="left"><code>AddTxidInv</code></td><td align="left">Adds a txid to the inventory.</td></tr>
<tr><td align="left"><code>AddTxidWithWitnessInv</code></td><td align="left">Adds a txid (with witness) to the inventory.</td></tr>
<tr><td align="left"><code>AddWtxidInv</code></td><td align="left">Adds a wtxid to the inventory.</td></tr>
<tr><td align="left"><code>AddBlockInv</code></td><td align="left">Adds a block hash to the inventory.</td></tr>
<tr><td align="left"><code>AddBlockWithWitnessInv</code></td><td align="left">Adds a block hash (with witness) to the inventory.</td></tr>
<tr><td align="left"><code>AddFilteredBlockInv</code></td><td align="left">Adds a filtered block to the inventory.</td></tr>
<tr><td align="left"><code>EndBuildInventory</code></td><td align="left">Finishes building the inventory.</td></tr>
<tr><td align="left"><strong>Message sending</strong></td><td align="left"><strong>Send messages to a node.</strong></td></tr>
<tr><td align="left"><code>SendRawMessage</code></td><td align="left">Sends a raw, untyped message.</td></tr>
<tr><td align="left"><code>SendGetData</code></td><td align="left">Sends a <code>getdata</code> message.</td></tr>
<tr><td align="left"><code>SendInv</code></td><td align="left">Sends an <code>inv</code> message.</td></tr>
<tr><td align="left"><code>SendTx</code></td><td align="left">Sends a <code>tx</code> message.</td></tr>
<tr><td align="left"><code>SendTxNoWit</code></td><td align="left">Sends a <code>tx</code> message without witness data.</td></tr>
<tr><td align="left"><code>SendHeader</code></td><td align="left">Sends a <code>header</code> message.</td></tr>
<tr><td align="left"><code>SendBlock</code></td><td align="left">Sends a <code>block</code> message.</td></tr>
<tr><td align="left"><code>SendBlockNoWit</code></td><td align="left">Sends a <code>block</code> message without witness data.</td></tr>
<tr><td align="left"><code>SendGetCFilters</code></td><td align="left">Sends a <code>getcfilters</code> message.</td></tr>
<tr><td align="left"><code>SendGetCFHeaders</code></td><td align="left">Sends a <code>getcfheaders</code> message.</td></tr>
<tr><td align="left"><code>SendGetCFCheckpt</code></td><td align="left">Sends a <code>getcfcheckpt</code> message.</td></tr>
<tr><td align="left"><strong>Other</strong></td><td align="left"></td></tr>
<tr><td align="left"><code>Nop</code></td><td align="left">No operation. Used during minimization.</td></tr>
</tbody></table>
<h3 id="mutators"><a class="header" href="#mutators">Mutators</a></h3>
<p>Several mutation strategies are available for IR programs:</p>
<ul>
<li><code>InputMutator</code>: Replaces an instruction's input variable with another
variable of compatible type. This mutation aims at changing the dataflow of a
given program by making an instruction operate on a different value.</li>
<li><code>OperationMutator</code>: Mutate an operation, e.g. mutate the input values of a
<code>Load*</code> operation. </li>
<li><code>CombineMutator</code>: Insert an entire IR program into another one at a random
location. This mutation aims at changing a program's control flow by
combining two programs into one.</li>
<li><code>ConcatMutator</code>: Append an entire IR program to another one at a random
location. This mutation aims at changing a program's control flow by
appending another program to it.</li>
</ul>
<p>Generators offer further mutation strategies that involve the generation of new
programs or new instructions into existing programs. They can be used to
bootstrap an initial corpus as well as to mutate existing inputs during a
fuzzing campaign. The following generators are available:</p>
<ul>
<li><code>SendMessageGenerator</code>: Generates a new <code>SendRawMessage</code> instruction</li>
<li><code>AdvanceTimeGenerator</code>: Generates new <code>AdvanceTime</code> and <code>SetTime</code>
instructions</li>
<li><code>CompactFilterQueryGenerator</code>: Generates new <code>SendGetCFilters</code>,
<code>SendGetCFHeaders</code> and <code>SendGetCFCheckpt</code> instructions</li>
<li><code>BlockGenerator</code>: Generates instructions to build a block</li>
<li><code>HeaderGenerator</code>: Generates instructions to build a header</li>
<li><code>AddTxToBlockGenerator</code>: Generates instructions to add a transaction to a
block</li>
<li><code>OneParentOneChildGenerator</code>: Generates instructions for building two new
transactions (a 1-parent 1-child package) and sending them to a node</li>
<li>... see
<a href="https://github.com/dergoegge/fuzzamoto/tree/master/fuzzamoto-ir/src/generators/">generators/</a></li>
</ul>
<h3 id="minimizers"><a class="header" href="#minimizers">Minimizers</a></h3>
<p>Minimizers are used to reduce the size of an interesting program (e.g. bug or
new coverage). The following minimization strategies are available:</p>
<ul>
<li><code>Nopping</code>: Attempt to nop out instructions in an effort to reduce the size of
a program.</li>
<li><code>Cutting</code>: Attempt to cut out instructions of the end of a program in an
effort to reduce the size of a program.</li>
<li><code>BlockNopping</code>: Attempt to nop out entire blocks of instructions in an effort
to reduce the size of a program (e.g. nop all instructions between and
including <code>BeginBlockTransactions</code> and <code>EndBlockTransactions</code>).</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                                                    <a rel="prev" href="../design/scenarios.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        
                                                    <a rel="next" href="../usage/aflpp.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                                    <a rel="prev" href="../design/scenarios.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                
                                    <a rel="next" href="../usage/aflpp.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                            </nav>

        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
        
                <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        
    </body>
</html>
